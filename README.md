# Autoencoder-for-Channel-Estimation

判定帰還通信路推定のための自己符号化器

## 概要
- 通信路はレイリーフェージング環境のMIMO通信路
- 通信路推定は通常のパイロット信号のみを用いた通信路推定に加え，繰り返し通信路推定と逐次通信路推定を選択可能
- ニューラルネットワーク (NN) で構成した変調器を自己符号化器により最適化
- 学習経過とシンボル誤り率 (SER) 特性を表示

### シミュレーションの流れ
- 送信機 <br>
ランダム生成された送信データが変調器に入力され，変調器は対応するシンボル（変調信号を複素表示したもの）を出力する．
- 通信路 <br>
送信信号は通信路を介して受信機へ届く．
本シミュレーションは，複数の送信アンテナと受信アンテナを用いて同一時刻に同一周波数を使用して通信するMIMO通信を想定している．
そのため，送信信号はフェージング（信号強度の変化）に加え，他の送信アンテナからの送信信号と相互干渉した状態で受信機へ届く．
- 受信機 <br>
受信機内で雑音が加算された受信信号が検出器に入力される．
検出器では事前に推定した通信路状態から信号の分離・検出が行われ，送信シンボルの判定値が出力される．
- 誤りシンボル数のカウント <br>
送信機の送信シンボルと受信機のシンボル判定値を比較し，誤りシンボル数をカウントする．
この処理を送信データを変えながら繰り返し行い，平均シンボル誤り率を算出する．

### 通信路推定方式の選択候補
受信側では信号検出の前に通信路状態を知る必要がある．
本プログラムでは以下の3つの通信路推定方式のうちいずれかを選択できる．
- 通常の通信路推定 <br> 
送信側はデータ信号を送る前に，パイロット信号と呼ばれる，送信側と受信側の双方で予め決めておいた信号を送り，受信側はその信号の変化から通信路状態を推定する．
- 繰り返し通信路推定 <br> 
まず最初に通常の通信路推定を行い，次に推定通信路を基に判定したデータ判定値を追加のパイロットとして利用して再度通信路推定を行うことで，推定精度を高める通信路推定方式．
- 逐次通信路推定 <br> 
信号検出段階直前の受信信号と送信信号判定値を用いて通信路推定を行うことで，フェージング環境が高速に変化する環境に対応できる推定方式．

### 自己符号化器
繰り返し通信路推定と逐次通信路推定では送信信号の判定値を用いて推定を行うため，
送信信号の判定誤りによって生じる非ガウス性雑音が信号検出精度を深刻に低下させる．
そこで本プログラムでは，
変調器をニューラルネットワーク (NN) で構成し，
送信機から受信機までの一連の流れを自己符号化器として構成することで，
受信機出力が送信機入力に近づくようにNNのパラメータを最適化する．
これにより，非ガウス性雑音に対する最適なシンボル配置を自動設計できる．

### プログラムの流れ
1. シミュレーション条件と学習条件の設定
2. 自己符号化器の学習 <br> 学習後は学習経過を表示
4. 性能テスト <br> テスト後はBER特性とSER特性を表示

詳細は文献[^MyPaper]を参照．
[^MyPaper]: https://ken.ieice.org/ken/paper/20230125LCpY/

## シミュレーションパラメータの説明

### 学習・テスト 共通設定
- SIM_base.M (int) - 送信アンテナ本数
- SIM_base.N (int) - 受信アンテナ本数
- SIM_base.Q_str (int) - 1アンテナあたりの多値数． $2$または $4^n$ ($n$は任意の自然数) で指定．
- SIM_bse.Kp (int) - パイロット長
- SIM_base.channel_type (str) - 通信路の状態．現在"wireless"のみ指定可能．
  - "wireless" - 通信環境はレイリーフェージング環境となり，通信路行列の各要素は平均0の複素ガウス分布に従う．
- SIM_base.channel_change (int) - 通信路状態の変化の仕方を指定できる．現在は0のみ指定可能．
  - 0 - 通信路状態は同一データフレーム内では変化しない．
- SIM_base.channel_estimate (str) - 通信路推定方式 <br>
  - "pilot" - 通常のパイロット信号のみによる繰り返し無しの通信路推定推定
  - "successive" - 逐次通信路推定
  - "iterative" - 繰り返し通信路推定
SIM_base.repeat_max (int) - 繰り返し推定回数（繰り返し通信路推定時のみ有効）
SIM_base.nworker (int) - 並列ワーカー数（並列処理は計算機サーバーでの実行時のみ行う）

### 学習設定
#### 通信環境
- SIM_train.noise_pilot (bool) - Falseならパイロットシンボルに雑音が乗らず（カンニング），Trueなら雑音が乗る．
- SIM_train.Kd (int) - 学習時のデータフレーム長
- SIM_train.EsN0 (float) - 学習時の $E_\mathrm{s} / N_0 \ [\mathrm{dB}]$
- SIM_train.upd_th (int) - 通信路推定行列の更新閾値（逐次通信路推定時のみ有効）
#### 層構造
- SIM_train.hidden_depth (int) - 中間層（隠れ層）の深さ
- SIM_train.hidden_dim (int) - 中間層（隠れ層）の次元
- SIM_train.activation_func (function) - 中間層（隠れ層）の活性化関数
#### 学習条件
- SIM_train.InitialLearnRate (float) - 初期学習率
- SIM_train.epochs (int) - エポック数
- SIM_train.scheduler_factor (float) - 学習率スケジューラの減衰係数
- SIM_train.scheduler_start (int) - 学習率スケジューラの減衰開始エポック
- SIM_train.scheduler_step (int) - 学習率スケジューラの減衰間隔

### テスト設定
- SIM_test.noise_pilot (bool) - Falseならパイロットシンボルに雑音が乗らず（カンニング），Trueなら雑音が乗る．
- SIM_test.Kd (int) - テスト時のデータフレーム長
- SIM_test.EsN0Vec (list, ndarray) - テスト時の $E_\mathrm{s} / N_0 \ [\mathrm{dB}]$を並べた一次元配列
- SIM_test.upd_th (int) - 通信路推定行列の更新閾値（逐次通信路推定時のみ有効）
- SIM_test.nloop_max (int, float) - $E_\mathrm{s}/N_0$毎のシミュレーション回数 <br>
シンボルエラー数がSymError_max（後述）に達するまで計算を継続する場合はfloat('inf')に設定する[^NotInf]．
- SIM_test.SymError_max (int, float) - 早期終了条件 <br>
シンボルエラー数がこの設定値に達すると，その $E_\mathrm{s} / N_0$でのシミュレーションを打ち切る．早期終了しない場合はfloat('inf')に設定する[^NotInf]．
[^NotInf]: nloop_maxとSymError_maxの両方をfloat('inf')に設定すると計算が終了しなため，どちらか一方は有限値に設定すること．
